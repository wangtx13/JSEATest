/* * @ # chop round rect connector 2 0 2006 01 14 * * copyright c 1996 2006 by the original authors of * and all its contributors * all rights reserved * * software is the confidential and proprietary information of * confidential information you shall not disclose * such confidential information and shall use it only in accordance * with the terms of the license agreement you entered into with * ??? */package draw * * geom * draw attribute keys * geom * /** * a chop round rect connector locates a connection point2 d by * chopping the connection at the horizontal and vertica lines defined by the * display box of a round rectangle figure * * @author werner randelshofer * @version 2 0 2006 01 14 changed to support coordinates * <br>1 0 2004 03 02 derived from shortest distance connector of * 6 0b1 */public chop round rect connector chop box connector { /** * only used dom storable input */ chop round rect connector { } chop round rect connector figure owner { owner } point2 d chop figure target point2 d from { target = get connector target target round rectangle figure rrf = round rectangle figure target rectangle2 d outer = rrf get bounds grow s t r o k e p l a c e m e n t get target { c e n t e r grow = attribute keys get stroke total width target / 2d o u t s e grow = attribute keys get stroke total width target i n s e grow = 0 } geom grow outer grow grow rectangle2 d inner = rectangle2 d outer clone gw = rrf get arc width + grow * 2 / 2 gh = rrf get arc height + grow *2 / 2 inner x = gw inner y = gh inner width += gw * 2 inner height += gh * 2 angle = geom point to angle outer from point2 d p = geom angle to point outer geom point to angle outer from p x == outer x || p x == outer x + outer width { p y = math min math max p y inner y inner y + inner height } { p x = math min math max p x inner x inner x + inner width } p }} 