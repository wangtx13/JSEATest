/* * @ # save action 1 2 1 2006 07 25 * * copyright c 2005 2006 werner randelshofer * staldenmattweg 2 immensee c h 6405 switzerland * all rights reserved * * software is the confidential and proprietary information of * werner randelshofer confidential information you shall not * disclose such confidential information and shall use it only in * accordance with the terms of the license agreement you entered into * with werner randelshofer */package app action * event * * io * app * io * * gui * gui event * /** * save action * * @author werner randelshofer * @version 1 2 1 2006 07 25 add saved to recent list of application * <br>1 2 2006 05 19 make filename acceptable by extension filter * <br>1 1 2006 02 23 support multiple open * <br>1 0 28 september 2005 created */public save action project action { = save save as component old focus owner /** creates a instance */ save action application app { app } /** creates a instance */ save action application app save as { app save as = save as resource bundle labels = resource bundle get l a f bundle app labels labels configure action } action performed action event evt { project project = get current project project is enabled { old focus owner = utilities get window ancestor project get component get focus owner project set enabled save to !save as project get != { save to project project get } { j chooser chooser = project get save chooser j sheet show save sheet chooser project get component sheet listener { option selected sheet event evt { evt get option == j chooser a p p r o v e o p t i o n { evt get chooser get filter extension filter { = extension filter evt get chooser get filter make acceptable evt get chooser get selected } { = evt get chooser get selected } save to project } { project set enabled old focus owner != { old focus owner request focus } } } } } } } save to project project { project execute worker { construct { { project write } i o e { e } } finished value { saved project value } } } /** * x x x change type of value to throwable * * @param value is either success or a throwable on failure */ saved project project value { value == { project set project mark changes as saved multi open = 1 project p project get application projects { p != project p get != p get equals { multi open = math max multi open p get multiple open + 1 } } get application add recent project set multiple open multi open } { j sheet show message sheet project get component <html> + u i manager get option pane css + <b> couldn't save to the \ +file+ \ <p> + reason +value j option pane e r r o r m e s s a g e } project set enabled utilities get window ancestor project get component to front old focus owner != { old focus owner request focus } }} 