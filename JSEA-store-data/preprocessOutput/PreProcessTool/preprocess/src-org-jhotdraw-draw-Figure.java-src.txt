figure 3 0 2006 01 20 1996 2006 disclose accordance draw beans geom undo io geom xml dom storable graphical figure <p> figure knows display box draw itself figure composed several figures interact manipulate figure provide handles connectors <p> figure has set handles manipulate shape attributes figure has one more connectors define how locate connection point <p> figures have open ended set attributes attribute identified attribute key <p> implementations figure are figure author 3 0 2006 01 20 reworked j2 s e 1 5 figure cloneable serializable dom storable d r i n g draws figure decorator figure g graphics2 d draw draw graphics2 d g gets layer figure layer used determine z ordering figure inside drawing figures higher layer number are drawn after figures lower number z order figures within same layer determined sequence figures were drawing figures later drawn after figures which have been before figure changes layer fire <code> figure listener figure changed< code> figure listeners f i x m e replace value layer get layer figure drawn drawing composite figure visible layouter s should ignore invisible figures too visible changes visible state figure <p> figure fires <code> figure listener figure changed< code> <code> undoable edit listener undoable edit happened< code> operation visible state < li> < ul> set visible value b o u n d s sets logical bounds figure decorator figure <p> used tool s which create figure tool s which connect figure another figure <p> basic operation which does fire events start start point bounds end end point bounds see #get bounds basic set bounds point2 d start point2 d end start point bounds see #basic set bounds point2 d get start point end point bounds see #basic set bounds point2 d get end point logical bounds figure rectangle logical bounds are used some handle adjusting figure rectangle2 d get bounds drawing bounding box figure decorator figure takes line width line caps other decorations account note get draw bounds include logical bounds figure rectangle2 d get draw bounds preferred size used layouter determine preferred size figure most figure s same dimensions get bounds dimension2 d get preferred size gets data which used restore shape figure after basic transform has been applied see #basic transform affine transform get restore data restores shape figure previously stored state restore restore data transforms shape figure transformations using precision arithmethics are inherently lossy operations therefore recommended get restore data restore provide lossless undo redo functionality after transform has finished bounds decorator figure are match transformed bounds figure <p> basic operation which does fire events tx transformation basic transform affine transform tx t t r i b u t e s sets attribute figure attribute key semantics are defined implementing figure <p> on attribute change figure fires <code> figure listener figure attribute changed< code> <code> undoable edit listener undoable edit happened< code> shape affected attribute change <code> figure listener figure changed< code> fired too set attribute attribute key key value sets attribute figure firing events attribute key semantics are defined implementing figure <p> <code> attribute key set < code> typesafe access see attribute key#set basic set attribute attribute key key value gets attribute figure <p> <code> attribute key get < code> typesafe access see attribute key#get attribute value figure does have attribute specified key key get value get attribute attribute key key view attributes figure convention unmodifiable map map< attribute key object> get attributes e d i t i n g user manipulate figure operation tool s should interact figure interactive checks point contained figure <p> used hit testing tool s contains point2 d p creates handles used manipulate figure detail level detail level handles usually 0 bounding box handles 1 point handles collection handles see handle collection< handle> create handles detail level cursor specified location cursor get cursor point2 d p collection action s specified location <p> collection contain entries these entries are used interpreted separators popup menu <p> actions property figure t i o n s u b m e n u specify submenu collection< action> get actions point2 d p specialized tool specified location <p> specialized tool available tool get tool point2 d p tooltip specified location get tooltip point2 d p o n n e t i n g checks figure connected connect gets connector figure at given location figure have different connectors at different locations p location connector prototype prototype used create connection unknown allows specific connectors different connection figures connector find connector point2 d p connection figure prototype gets compatible connector connector figure connector connector another figure connector same semantics figure compatible connector available connector find compatible connector connector start connector sets whether connectors should visible specified courting connector connectors optionally visible set connectors visible visible connection figure courting connection figure draws connectors connectors visible o m p o s i t e f i g u r e s checks whether given figure contained figure figure includes itself includes figure figure figure contains given point figure find figure inside point2 d p decompositon figure parts figure considered itself collection< figure> get decomposition l o n i n g clone figure clone after cloning collection figures connection figures contained collection still connect figures instead clones using operation providing map which maps collection figures collection connections remapped figures remap map< figure figure> old e v e n t h n d l i n g informs figure has been specified drawing figure inform figure listeners has been add notify drawing d informs figure has been specified drawing figure inform figure listeners has been remove notify drawing d informs figure about change shape <p> <code>will change< code> <code>changed< code> are typically used pairs before after invoking one multiple basic on figure change informs figure shape fires <code> figure listener figure changed< code> current display bounds figure see #will change informs figure has invalidated display area needs drawn fires <code> figure listener area invalidated< code> invalidate fires <code> figure listener figure request remove< code> request remove handles drop p location mouse dropped figures dropped figures view drawing view which mouse figures should snap back location they were dragged handle drop point2 d p collection< figure> dropped figures drawing view view handles mouse click p location mouse evt mouse view drawing view which mouse figure consumed mouse click handle mouse click point2 d p mouse evt drawing view view adds listener figure s add figure listener figure listener l removes listener figure s remove figure listener figure listener l adds listener undoable edit events add undoable edit listener undoable edit listener l removes listener undoable edit events remove undoable edit listener undoable edit listener l sets decorator figure set decorator desired decorator same logical bounds figure drawn when figure drawn set decorator figure value gets decorator figure figure get decorator 