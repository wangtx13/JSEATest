drawing 2 0 2006 01 14 1996 2006 disclose accordance ??? draw reversed list geom undo drawing author 2 0 2006 01 14 support precision coordinates <br>1 0 2003 12 01 derived 5 4b1 drawingextends drawingimplements figure listener undoable edit listener list< figure> figures = list< figure> needs sorting = creates instance drawing index figure figure figures index figure basic add index figure figure figures add index figure figure add figure listener figure add undoable edit listener invalidate sort order basic remove figure figure figures remove figure figure remove figure listener figure remove undoable edit listener invalidate sort order draw graphics2 d g get lock ensure sorted list< figure> draw = list< figure> figures size rectangle clip rect = g get clip bounds figure f figures f get draw bounds intersects clip rect draw add f draw g draw draw graphics2 d g collection< figure> figures figure f figures f visible f draw g collection< figure> sort collection< figure> hash set< figure> unsorted = hash set< figure> unsorted add list< figure> sorted = list< figure> size figure f figures unsorted contains f sorted add f unsorted remove f figure f unsorted contains f sorted add f unsorted remove f sorted figure area invalidated figure e fire area invalidated e get invalidated area figure figure e invalidate sort order fire area invalidated e get invalidated area figure figure e figure figure e figure request remove figure e remove e get figure figure find figure point2 d p figure f get figures front back f visible f contains p f figure find figure except point2 d p figure ignore figure f get figures front back f != ignore f visible f contains p f figure find figure except point2 d p collection< figure> ignore figure f get figures front back ! ignore contains f f visible f contains p f collection< figure> find figures rectangle2 d bounds list< figure> intersection = list< figure> figure f figures f visible f get bounds intersects bounds intersection add f intersection collection< figure> find figures within rectangle2 d bounds list< figure> contained = list< figure> figure f figures f visible bounds contains f get bounds contained add f contained collection< figure> get figures unmodifiable collection figures figure find figure inside point2 d p figure f = find figure p f == ? f find figure inside p iterator iterate z order front back over figures list< figure> get figures front back ensure sorted reversed list< figure> figures bring front figure figure figures remove figure figures add figure invalidate sort order fire area invalidated figure get draw bounds send back figure figure figures remove figure figures add 0 figure invalidate sort order fire area invalidated figure get draw bounds we propagate edit events our figures undoable edit listeners which have registered us undoable edit happened undoable edit e fire undoable edit happened e get edit figure attribute figure e contains figure f figures contains f invalidates sort order invalidate sort order needs sorting = ensures figures are sorted z order sequence back front ensure sorted needs sorting sort figures figure layer comparator i n s t n e needs sorting = 