round rectangle figure 2 2 2006 06 17 1996 2006 disclose accordance draw geom io undo draw attribute keys geom xml dom input xml dom output rectangle2 d round corners author 2 2 2006 06 17 chop 2 1 2006 05 29 basic set bounds did work bounds smaller than 1 pixel <br>2 0 2006 01 14 support coordinates <br>1 0 2004 03 02 derived 6 0b1 round rectangle figure attributed figure round rectangle2 d roundrect d e f u l t r = 20 creates instance round rectangle figure 0 0 0 0 round rectangle figure x y width height roundrect = round rectangle2 d x y width height d e f u l t r d e f u l t r f i l l o l o r set color white s t r o k e o l o r set color black rectangle2 d get bounds rectangle2 d roundrect get bounds2 d rectangle2 d get figure draw bounds rectangle2 d r = rectangle2 d roundrect get bounds2 d grow = attribute keys get perpendicular hit growth geom grow r grow grow r get arc width roundrect arcwidth get arc height roundrect archeight set arc h old width = roundrect get arc width old height = roundrect get arc height roundrect arcwidth = roundrect archeight = h fire figure get draw bounds fire undoable edit happened undoable edit get presentation rundung undo cannot undo undo change roundrect arcwidth = old width roundrect archeight = old height redo cannot redo redo change roundrect arcwidth = roundrect archeight = h draw fill graphics2 d g round rectangle2 d r = round rectangle2 d roundrect clone grow = attribute keys get perpendicular fill growth r x = grow r y = grow r width += grow 2 r height += grow 2 r arcwidth += grow 2 r archeight += grow 2 r width > 0 r height > 0 g fill r draw stroke graphics2 d g round rectangle2 d r = round rectangle2 d roundrect clone grow = attribute keys get perpendicular draw growth r x = grow r y = grow r width += grow 2 r height += grow 2 r arcwidth += grow 2 r archeight += grow 2 r width > 0 r height > 0 g draw r checks point2 d inside figure contains point2 d p round rectangle2 d r = round rectangle2 d roundrect clone grow = attribute keys get perpendicular hit growth r x = grow r y = grow r width += grow 2 r height += grow 2 r arcwidth += grow 2 r archeight += grow 2 r contains p basic set bounds point2 d anchor point2 d roundrect x = math anchor x x roundrect y = math anchor y y roundrect width = math 0 1 math abs x anchor x roundrect height = math 0 1 math abs y anchor y transforms figure tx transformation basic transform affine transform tx point2 d anchor = get start point point2 d = get end point basic set bounds point2 d tx transform anchor anchor point2 d tx transform collection< handle> create handles detail level linked list< handle> handles = linked list< handle> create handles detail level handles add round rect radius handle handles connector find connector point2 d p connection figure prototype chop round rect connector connector find compatible connector connector start connector chop round rect connector round rectangle figure clone round rectangle figure = round rectangle figure clone roundrect = round rectangle2 d roundrect clone override read dom input i o read roundrect arcwidth = get attribute arc width d e f u l t r roundrect archeight = get attribute arc height d e f u l t r override write dom output out i o write out out add attribute arc width roundrect arcwidth out add attribute arc height roundrect archeight restore geometry round rectangle2 d r = round rectangle2 d geometry roundrect x = r x roundrect y = r y roundrect width = r width roundrect height = r height get restore data roundrect clone point2 d chop point2 d rectangle2 d outer = get bounds grow s t r o k e p l e m e n t get e n t e r grow = attribute keys get stroke total width 2 o u t s e grow = attribute keys get stroke total width i n s e grow = 0 outer x = grow outer y = grow outer width += grow 2 outer height += grow 2 rectangle2 d inner = rectangle2 d outer clone gw = get arc width + grow 2 2 gh = get arc height + grow 2 2 inner x = gw inner y = gh inner width += gw 2 inner height += gh 2 angle = geom point angle outer point2 d p = geom angle point outer geom point angle outer p x == outer x || p x == outer x + outer width p y = math math p y inner y inner y + inner height p x = math math p x inner x inner x + inner width p 