std xml reader nano xml $ revision 1 4 $ $ date 2002 01 04 21 03 28 $ $ r e l e s e 2 2 1 $ nano xml 2 2000 2002 purpose 1 2 3 net n3 io input stream io input stream reader io i o io io input stream io found io line number reader io pushback reader io pushback input stream io reader io reader io unsupported encoding net malformed u r l net u r l stack std xml reader reads data parsed author $ r e l e s e 2 2 1 $ $ revision 1 4 $ std xml reader i xml reader stacked reader author $ r e l e s e 2 2 1 $ $ revision 1 4 $ stacked reader pushback reader pb reader line number reader line reader u r l stack readers stack readers current push back reader stacked reader current reader creates reader using input str containing xml data i xml reader reader str std xml reader reader str creates reader using input filename containing xml data io found could found io i o i o occurred i xml reader reader filename found i o std xml reader r = std xml reader input stream filename r set filename i = 0 i < r readers size i++ stacked reader sr = stacked reader r readers element at i sr = r current reader r initializes reader which non malformed u r l does contain valid u r l found refers local which does i o occurred opening stream std xml reader malformed u r l found i o u r l idas u r l = idas u r l = u r l malformed u r l e = + idas u r l = u r l malformed u r l e2 e current reader = stacked reader readers = stack reader reader = open stream idas u r l current reader line reader = line number reader reader current reader pb reader = pushback reader current reader line reader 2 initializes xml reader reader input xml data std xml reader reader reader current reader = stacked reader readers = stack current reader line reader = line number reader reader current reader pb reader = pushback reader current reader line reader 2 current reader = current reader = u r l malformed u r l e never happens cleans up when s destroyed finalize throwable current reader line reader = current reader pb reader = current reader = current reader = current reader = readers clear finalize scans encoding lt ?xml ? tag str first tag xml data encoding encoding has been specified get encoding str ! str starts <?xml index = 5 index < str length buffer key = buffer index < str length str at index <= index++ index < str length str at index >= str at index <= z key append str at index index++ index < str length str at index <= index++ index >= str length || str at index != = index < str length str at index != \ str at index != index++ index >= str length delimiter = str at index index++ index2 = str index delimiter index index2 < 0 key equals encoding str substring index index2 index = index2 + 1 converts stream reader detecting encoding stream input xml data chars read buffer where put have been read io i o i o occurred reader stream2reader input stream stream buffer chars read i o pushback input stream pbstream = pushback input stream stream b = pbstream read b 0x00 0x f e 0x f f pbstream unread b input stream reader pbstream u t f 16 0x e f i = 0 i < 2 i++ pbstream read input stream reader pbstream u t f 8 0x3 b = pbstream read chars read append < b > 0 b != 0x3 e chars read append b b = pbstream read b > 0 chars read append b encoding = get encoding chars read encoding == input stream reader pbstream u t f 8 chars read set length 0 input stream reader pbstream encoding unsupported encoding e input stream reader pbstream u t f 8 chars read append b input stream reader pbstream u t f 8 initializes xml reader stream input xml data io i o i o occurred std xml reader input stream stream i o pushback input stream pbstream = pushback input stream stream buffer chars read = buffer reader reader = stream2reader stream chars read current reader = stacked reader readers = stack current reader line reader = line number reader reader current reader pb reader = pushback reader current reader line reader 2 current reader = current reader = u r l malformed u r l e never happens start stream reader chars read reads character character io i o character could read read i o ch = current reader pb reader read ch < 0 readers empty i o unexpected e o f current reader pb reader close current reader = stacked reader readers pop ch = current reader pb reader read ch current stream has more left read io i o i o occurred at e o f current stream i o ch = current reader pb reader read ch < 0 current reader pb reader unread ch there are more left read io i o i o occurred at e o f i o ch = current reader pb reader read ch < 0 readers empty current reader pb reader close current reader = stacked reader readers pop ch = current reader pb reader read current reader pb reader unread ch pushes last character read back stream ch character push back io i o i o occurred unread ch i o current reader pb reader unread ch opens stream which which never net malformed u r l does contain valid u r l io found refers local which does io i o occurred opening stream reader open stream malformed u r l found i o u r l url = u r l current reader url get ref != ref = url get ref url get length > 0 url = u r l url get protocol url get host url get port url get url = u r l jar + url + ! + ref url = std xml reader get resource ref current reader = current reader = url buffer chars read = buffer reader reader = stream2reader url open stream chars read chars read length == 0 reader chars read str = chars read pushback reader pbreader = pushback reader reader chars read str length i = chars read str length 1 i >= 0 i pbreader unread chars read str at i pbreader starts stream reader stream used temporary read data stream exhausted control parent stream reader non reader read data start stream reader reader start stream reader starts stream reader stream used temporary read data stream exhausted control parent stream reader non reader read data internal entity reader produced resolving internal entity start stream reader reader internal entity stacked reader old reader = current reader readers push current reader current reader = stacked reader internal entity current reader line reader = current reader pb reader = pushback reader reader 2 current reader line reader = line number reader reader current reader pb reader = pushback reader current reader line reader 2 current reader = old reader current reader = old reader current level stream on stack streams get stream level readers size line number data current stream get line nr current reader line reader == stacked reader sr = stacked reader readers peek sr line reader == 0 sr line reader get line number + 1 current reader line reader get line number + 1 sets current stream net malformed u r l does contain valid u r l set malformed u r l current reader = u r l current reader sets current stream set current reader = current get current reader current get current reader 