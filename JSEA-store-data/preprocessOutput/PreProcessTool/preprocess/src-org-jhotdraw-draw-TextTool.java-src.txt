text tool 1 0 19 november 2003 1996 2006 disclose accordance ??? draw tool create edit existing text figures editing behavior overlaying figure providing text floating text field <p> tool interaction done once figure text holder clicked see text holder see floating text field author 2 0 2006 01 14 support coordinates <br>1 0 2003 12 01 derived 5 4b1 text tool creation tool action listener floating text field text field text holder typing target creates instance text tool text holder prototype prototype creates instance text tool figure prototype map attributes prototype attributes deactivate drawing editor editor end edit deactivate editor pressed figure text holder edited otherwise text figure created mouse pressed mouse e text holder text holder = figure pressed figure = get drawing find figure inside get view view drawing point e get x e get y pressed figure text holder text holder = text holder pressed figure get label !text holder editable text holder = text holder != begin edit text holder typing target != end edit fire tool done mouse pressed e update view so created figure drawn before floating text figure overlaid note f damage should standard drawing view when overlay figure drawn because j text field cannot scrolled view check damage text holder = text holder get created figure begin edit text holder mouse dragged mouse e begin edit text holder text holder text field == text field = floating text field text field add action listener text holder != typing target typing target != end edit text field create overlay get view text holder text field set bounds get field bounds text holder text holder get text text field request focus typing target = text holder rectangle get field bounds text holder figure rectangle box = get view drawing view figure get bounds n chars = figure get text columns dimension d = text field get preferred size n chars d width = math box width d width rectangle box x 6 box y 4 d width d height rectangle box = get view drawing view figure get bounds dimension d = text field get preferred size 3 d width = math box width d width insets insets = text field get insets rectangle box x insets left box y insets top box width + insets left + insets right box height + insets top + insets bottom mouse released mouse evt created figure != rectangle bounds = created figure get bounds bounds width == 0 bounds height == 0 get drawing remove created figure get view add selection created figure created figure = get drawing fire undoable edit happened creation edit fire tool done end edit typing target != typing target change text field get text length > 0 typing target set text text field get text created figure != get drawing fire undoable edit happened creation edit created figure = created figure != get drawing remove figure get figure typing target set text nothing undo set undo activity typing target typing target = text field end overlay view check damage action performed action end edit fire tool done 