chop diamond connector 1 0 27 m???rz 2006 1996 2006 disclose accordance ??? draw geom draw attribute keys geom chop diamond connector locates connection points choping connection between centers two figures at edge diamond figure author 1 0 27 m???rz 2006 created chop diamond connector chop box connector chop diamond connector used storable chop diamond connector figure owner owner appropriate connection point on edge diamond figure point2 d chop figure target point2 d target = get connector target target rectangle2 d r = target get bounds diamond figure i s q u d r t i get target side = math r width r height r x = side r width 2 r y = side r height 2 r width = r height = side growx growy f i x m e wrong copy correct diamond figure s t r o k e p l e m e n t get target i n s e growx = growy = 0f o u t s e line length = math sqrt r width r width + r height r height scale = get stroke total width target 2d line length growx = scale r height growy = scale r width growy = get stroke total width s q r t2 e n t e r line length = math sqrt r width r width + r height r height scale = get stroke total width target line length growx = scale r height growy = scale r width growx = growy = get stroke total width 2d s q r t2 geom grow r growx growy center point point2 d c1 = point2 d r x + r width 2 r y + r height 2 point2 d p2 = point2 d r x + r width 2 r y + r height point2 d p4 = point2 d r x + r width 2 r y overlapping just opposite corners r contains y > r y y < r y +r height 2 p2 p4 calculate angle determine quadrant ang = geom point angle r dermine line points point2 d p1 = point2 d r x + r width r y + r height 2 point2 d p3 = point2 d r x r y + r height 2 point2 d rp = get intersection edges ang > 0 ang < 1 57 rp = geom intersect p1 x p1 y p2 x p2 y c1 x c1 y x y ang > 1 575 ang < 3 14 rp = geom intersect p2 x p2 y p3 x p3 y c1 x c1 y x y ang > 3 14 ang < 1 575 rp = geom intersect p3 x p3 y p4 x p4 y c1 x c1 y x y ang > 1 57 ang < 0 rp = geom intersect p4 x p4 y p1 x p1 y c1 x c1 y x y proper edge found we should send one four corners rp == rp = geom angle point r ang rp 