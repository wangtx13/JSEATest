bezier control point handle 1 0 23 januar 2006 1996 2006 disclose accordance draw undo geom geom bezier control point handle author 1 0 23 januar 2006 created bezier control point handle handle index control point index composite edit edit creates instance bezier control point handle bezier figure owner index coord owner index = index control point index = coord bezier figure get bezier figure bezier figure get owner point get location get bezier figure get point count > index ? view drawing view get bezier figure get point index control point index point 10 10 draws handle draw graphics2 d g bezier figure f = get bezier figure f get point count > index bezier path node v = f get node index v keep colinear v mask == bezier path c1 c2 m s k index > 0 index < f get node count || f closed draw circle g color white color blue draw circle g color blue color white g set color color blue g draw line2 d view drawing view point2 d v x 0 v y 0 view drawing view point2 d v x control point index v y control point index rectangle basic get bounds rectangle r = rectangle get location r grow get handlesize 2 get handlesize 2 r track start point anchor modifiers ex view get drawing fire undoable edit happened edit = composite edit punkt verschieben point2 d location = view get constrainer constrain point view view drawing get location point2 d p = view get constrainer constrain point view view drawing anchor track step point anchor point modifiers ex bezier figure figure = get bezier figure point2 d p = view get constrainer constrain point view view drawing bezier path node v = figure get node index fire area invalidated v figure change ! v keep colinear move control point independently figure basic set point index control point index p move control point opposite control point on same line = math p i + math atan2 p y v y 0 p x v x 0 c2 = control point index == 1 ? 2 1 r = math sqrt v x c2 v x 0 v x c2 v x 0 + v y c2 v y 0 v y c2 v y 0 sina = math sin cosa = math cos point2 d p2 = point2 d r cosa + v x 0 r sina + v y 0 figure basic set point index control point index p figure basic set point index c2 p2 figure fire area invalidated figure get node index fire area invalidated bezier path node v rectangle2 d dr = rectangle2 d v x 0 v y 0 0 0 i=1 i < 3 i++ dr add v x i v y i rectangle vr = view drawing view dr vr grow get handlesize get handlesize fire area invalidated vr track end point anchor point modifiers ex bezier figure figure = get bezier figure modifiers ex input m e t d o n m s k | input t r l d o n m s k != 0 figure change bezier path node v = figure get node index v keep colinear = ! v keep colinear v keep colinear move control point opposite control point on same line point2 d p = figure get point index control point index = math p i + math atan2 p y v y 0 p x v x 0 c2 = control point index == 1 ? 2 1 r = math sqrt v x c2 v x 0 v x c2 v x 0 + v y c2 v y 0 v y c2 v y 0 sina = math sin cosa = math cos point2 d p2 = point2 d r cosa + v x 0 r sina + v y 0 v x c2 = p2 x v y c2 = p2 y figure set node index v figure view get drawing fire undoable edit happened edit combinable handle h combinable h bezier control point handle = bezier control point handle h index == index control point index == control point index get bezier figure get node count == get bezier figure get node count 