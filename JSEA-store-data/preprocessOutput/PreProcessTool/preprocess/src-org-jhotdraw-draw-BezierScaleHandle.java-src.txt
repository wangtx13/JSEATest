bezier scale handle 1 0 16 juni 2006 1996 2006 disclose accordance draw undo geom geom handle scale rotate bezier figure pressing alt key shift key manipulating handle restricts handle rotate bezier figure author 1 0 16 juni 2006 created bezier scale handle handle point location restore data affine transform transform point2 d center start theta start length creates instance bezier scale handle bezier figure owner owner combinable handle h draws handle draw graphics2 d g draw circle g color yellow color black rectangle basic get bounds rectangle r = rectangle get location r grow get handlesize 2 get handlesize 2 r point get location location == location = view drawing view get location bezier figure get bezier figure bezier figure get owner point2 d get find nice place put handle need pick place overlap point handle internal polygon handlesize = get handlesize one handlesize step away outermost toward center point2 d outer = get bezier figure get outermost point point2 d ctr = get bezier figure get center len = geom length outer x outer y ctr x ctr y len == 0 best we do? point2 d outer x handlesize 2 outer y + handlesize 2 u = handlesize len u > 1 0 best we do? point2 d outer x 3 + ctr x 4 outer y 3 + ctr y 4 point2 d outer x 1 0 u + ctr x u outer y 1 0 u + ctr y u track start point anchor modifiers ex location = point anchor x anchor y restore data = get bezier figure get restore data transform = affine transform center = get bezier figure get center point2 d anchor point = view view drawing anchor start theta = geom angle center x center y anchor point x anchor point y start length = geom length center x center y anchor point x anchor point y track step point anchor point modifiers ex location = point x y point2 d point = view view drawing step theta = geom angle center x center y point x point y step length = geom length center x center y point x point y scale factor = modifiers ex input l t d o n m s k | input s h i f t d o n m s k != 0 ? 1d step length start length transform set identity transform translate center x center y transform scale scale factor scale factor transform rotate step theta start theta transform translate center x center y get owner change get owner restore restore data get owner basic transform transform get owner scale rotate point anchor polygon polygon point p change center determine relative angles lengths point ctr = center polygon anchor len = geom length ctr x ctr y anchor x anchor y anchor len > 0 0 len = geom length ctr x ctr y p x p y ratio = len anchor len anchor angle = math atan2 anchor y ctr y anchor x ctr x angle = math atan2 p y ctr y p x ctr x rotation = angle anchor angle n = polygon npoints xs = n ys = n i = 0 i < n ++i x = polygon xpoints i y = polygon ypoints i l = geom length ctr x ctr y x y ratio = math atan2 y ctr y x ctr x + rotation xs i = ctr x + l math cos + 0 5 ys i = ctr y + l math sin + 0 5 set internal polygon polygon xs ys n track end point anchor point modifiers ex view get drawing fire undoable edit happened restore data edit get owner restore data location = 