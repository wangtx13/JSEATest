drag tracker 2 0 2006 01 14 1996 2006 disclose accordance ??? draw geom drag tracker author 2 0 2006 01 14 support precision coordinates <br>1 0 2003 12 01 derived 5 4b1 drag tracker tool figure anchor figure point2 d old point point2 d anchor point dragging creates instance drag tracker figure figure anchor figure = figure mouse moved mouse evt update cursor editor find view container evt get point evt get x evt get y mouse pressed mouse evt mouse pressed evt drawing view view = get view evt shift down view set handle detail level 0 view toggle selection anchor figure ! view figure selected anchor figure anchor figure = ! view figure selected anchor figure view set handle detail level 0 view clear selection view add selection anchor figure point2 d = point2 d m x v l u e m x v l u e figure f view get selected figures rectangle2 d b = f get bounds x = math x b x y = math y b y point2 d constrained = view get constrainer constrain point point2 d x y old point = view get constrainer constrain point view view drawing point evt get x evt get y old point x += x constrained x old point y += y constrained y anchor point = old point mouse dragged mouse evt drawing view view = get view dragging = dragging = update cursor editor find view container evt get point evt get x evt get y point2 d point = view get constrainer constrain point view view drawing point evt get x evt get y affine transform tx = affine transform tx translate point x old point x point y old point y figure f view get selected figures f change f basic transform tx f old point = point mouse released mouse evt mouse released evt dragging = x = evt get x y = evt get y update cursor editor find view container evt get point evt get x evt get y point2 d p = get view get constrainer constrain point get view view drawing point x y collection< figure> dragged figures = linked list get view get selected figures figure drop target = get drawing find figure except p dragged figures drop target != snap back = drop target handle drop p dragged figures get view snap back affine transform tx = affine transform tx translate anchor point x old point x anchor point y old point y figure f dragged figures f change f basic transform tx f affine transform tx = affine transform tx translate anchor point x + old point x anchor point y + old point y ! tx identity get drawing fire undoable edit happened transform edit dragged figures tx affine transform tx = affine transform tx translate anchor point x + old point x anchor point y + old point y ! tx identity get drawing fire undoable edit happened transform edit dragged figures tx fire tool done 