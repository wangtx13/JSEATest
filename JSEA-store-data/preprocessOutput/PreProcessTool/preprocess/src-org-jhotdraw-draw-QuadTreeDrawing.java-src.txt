quad tree drawing 2 0 2006 01 14 1996 2006 disclose accordance ??? draw geom quad tree2 d reversed list geom quad tree drawing uses quad tree2 d improve responsiveness drawings which contain many figures author 2 0 2006 01 14 support precision coordinates <br>1 0 2003 12 01 derived 5 4b1 quad tree drawing drawingimplements figure listener undoable edit listener list< figure> figures = list< figure> quad tree2 d double< figure> quad tree = quad tree2 d double< figure> needs sorting = creates instance quad tree drawing index figure figure figures index figure basic add index figure figure figures add index figure quad tree add figure figure get draw bounds figure add figure listener figure add undoable edit listener needs sorting = basic remove figure figure figures remove figure quad tree remove figure figure remove figure listener figure remove undoable edit listener needs sorting = draw graphics2 d g collection< figure> = quad tree find intersects g get clip bounds get bounds2 d collection< figure> draw = sort draw g draw note sorting done orphaned figures collection< figure> sort collection< figure> ensure sorted list< figure> sorted = list< figure> size figure f figures contains f sorted add f sorted draw graphics2 d g collection< figure> figure f f draw g figure area invalidated figure e fire area invalidated e get invalidated area figure figure e quad tree remove e get figure quad tree add e get figure e get figure get draw bounds needs sorting = fire area invalidated e get invalidated area figure figure e figure figure e figure request remove figure e remove e get figure collection< figure> get figures rectangle2 d bounds quad tree find inside bounds collection< figure> get figures unmodifiable collection figures figure find figure inside point2 d p collection< figure> = quad tree find contains p figure f get figures front back contains f f contains p f find figure inside p iterator iterate z order front back over figures list< figure> get figures front back ensure sorted reversed list< figure> figures figure find figure point2 d p collection< figure> = quad tree find contains p size 0 1 figure f = iterator next f contains p ? f figure f get figures front back contains f f contains p f figure find figure except point2 d p figure ignore collection< figure> = quad tree find contains p size 0 1 figure f = iterator next f == ignore || ! f contains p ? f figure f get figures front back f != ignore f contains p f figure find figure except point2 d p collection ignore collection< figure> = quad tree find contains p size 0 1 figure f = iterator next ! ignore contains f || ! f contains p ? f figure f get figures front back ! ignore contains f f contains p f collection< figure> find figures rectangle2 d r collection< figure> = quad tree find intersects r size 0 fall through 1 sort collection< figure> find figures within rectangle2 d r collection< figure> = find figures r list< figure> result = list< figure> size figure f r contains f get bounds result add f result bring front figure figure figures remove figure figures add figure needs sorting = fire area invalidated figure get draw bounds send back figure figure figures remove figure figures add 0 figure needs sorting = fire area invalidated figure get draw bounds we propagate edit events our figures undoable edit listeners which have registered us undoable edit happened undoable edit e fire undoable edit happened e get edit figure attribute figure e contains figure f figures contains f ensures figures are sorted z order sequence ensure sorted needs sorting sort figures figure layer comparator i n s t n e needs sorting = 