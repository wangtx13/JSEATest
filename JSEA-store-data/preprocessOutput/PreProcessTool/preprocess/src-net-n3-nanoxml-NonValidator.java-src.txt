non validator nano xml $ revision 1 4 $ $ date 2002 02 03 21 19 38 $ $ r e l e s e 2 2 1 $ nano xml 2 2000 2002 purpose 1 2 3 net n3 io reader io i o io reader enumeration hashtable properties stack non validator concrete i xml validator which processes d t d handles entity definitions does validation itself author $ r e l e s e 2 2 1 $ $ revision 1 4 $ non validator i xml validator parameter entity resolver i xml entity resolver parameter entity resolver contains values attributes different element types hashtable attribute values stack elements processed stack current elements creates validator non validator attribute values = hashtable current elements = stack parameter entity resolver = xml entity resolver cleans up when s destroyed finalize throwable parameter entity resolver = attribute values clear attribute values = current elements clear current elements = finalize sets parameter entity resolver resolver entity resolver set parameter entity resolver i xml entity resolver resolver parameter entity resolver = resolver parameter entity resolver entity resolver i xml entity resolver get parameter entity resolver parameter entity resolver parses d t d validator responsible reading full d t d which reader reader read d t d entity resolver entity resolver external d t d external something went wrong parse d t d i xml reader reader i xml entity resolver entity resolver external xml skip whitespace reader orig level = reader get stream level str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver ch == < process element reader entity resolver ch == end internal d t d xml invalid input reader get reader get line nr str ch = reader read external reader get stream level < orig level reader unread ch end external d t d ch == || ch == || ch == || ch == \r reader unread ch processes element d t d reader reader read data entity resolver entity resolver something went wrong process element i xml reader reader i xml entity resolver entity resolver str = xml read reader % ch = str at 0 ch != ! xml skip tag reader str = xml read reader % ch = str at 0 ch xml skip comment reader process conditional section reader entity resolver e process entity reader entity resolver process att list reader entity resolver xml skip tag reader processes conditional section reader reader read data entity resolver entity resolver something went wrong process conditional section i xml reader reader i xml entity resolver entity resolver xml skip whitespace reader str = xml read reader % ch = str at 0 ch != i xml skip tag reader str = xml read reader % ch = str at 0 ch g process ignore section reader entity resolver n xml skip tag reader ! xml check literal reader l u d e xml skip tag reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch != xml skip tag reader reader subreader = d t reader reader buffer buf = buffer 1024 ch2 = subreader read ch2 < 0 buf append ch2 subreader close reader start stream reader buf processes ignore section reader reader read data entity resolver entity resolver something went wrong process ignore section i xml reader reader i xml entity resolver entity resolver ! xml check literal reader n o r e xml skip tag reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch != xml skip tag reader reader subreader = d t reader reader subreader close processes t t l i s t element reader reader read data entity resolver entity resolver something went wrong process att list i xml reader reader i xml entity resolver entity resolver ! xml check literal reader t t l i s t xml skip tag reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 reader unread ch element = xml scan identifier reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 properties props = properties ch != > reader unread ch att = xml scan identifier reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 ch == ch != str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 reader unread ch xml scan identifier reader xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 ch == str = xml scan identifier reader xml skip whitespace reader ! str equals f i x e d xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 reader unread ch value = xml scan reader % parameter entity resolver props put att value xml skip whitespace reader str = xml read reader % ch = str at 0 ch == % xml process entity str reader parameter entity resolver str = xml read reader % ch = str at 0 ! props empty attribute values put element props processes e n t i t y element reader reader read data entity resolver entity resolver something went wrong process entity i xml reader reader i xml entity resolver entity resolver ! xml check literal reader n t i t y xml skip tag reader xml skip whitespace reader ch = xml read reader \0 ch == % xml skip whitespace reader entity resolver = parameter entity resolver reader unread ch key = xml scan identifier reader xml skip whitespace reader ch = xml read reader % = = ch p ! xml check literal reader u b l i xml skip tag reader xml skip whitespace reader = xml scan reader % parameter entity resolver xml skip whitespace reader = xml scan reader % parameter entity resolver xml skip whitespace reader xml read reader % s ! xml check literal reader y s t e m xml skip tag reader xml skip whitespace reader = xml scan reader % parameter entity resolver xml skip whitespace reader xml read reader % \ reader unread ch value = xml scan reader % parameter entity resolver entity resolver add internal entity key value xml skip whitespace reader xml read reader % xml skip tag reader != entity resolver add external entity key indicates element has been started element xml data element line nr line number xml data element element started line nr properties attribs = properties attribute values get attribs == attribs = properties attribs = properties attribs clone current elements push attribs indicates current element has ended element xml data element line nr line number xml data element element ended line nr nothing called when attributes xml element have been processed there are attributes value which have been specified yet they have put < i>extra attributes< i> element extra attributes where put extra attributes xml data element line nr line number xml data element element attributes processed properties extra attributes line nr properties props = properties current elements pop enumeration enm = props keys enm has more elements key = enm next element extra attributes put key props get key indicates attribute has been current element key attribute value value attribute xml data element line nr line number xml data element attribute key value line nr properties props = properties current elements peek props contains key key props remove key indicates p d t element has been encountered xml data element line nr line number xml data element p data line nr nothing 