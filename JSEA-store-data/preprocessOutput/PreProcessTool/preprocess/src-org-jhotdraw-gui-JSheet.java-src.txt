j sheet 2 0 2006 07 02 2005 2006 staldenmattweg 2 immensee h 6405 switzerland disclose accordance gui peer beans reflect plaf gui j sheet document modal dialog which displayed below title bar j frame <p> j sheet blocks input on owner window visible <p> unlike application modal dialogs show j sheet does immediately when j sheet has become visible need sheet listener get value j sheet <p> requires 1 4 <p> caveats we are using unsupported p i call make j sheet translucent p i go away future macintosh runtime we hopefully just end up non opaque sheet author 1 4 2006 07 02 rewritten independent quaqua look feel <br>1 3 2006 04 15 request focus show window title parent window when displaying sheet regular dialog window <br>1 2 2006 02 18 set window decoration style n o n e get sheet border u i manager <br>1 1 2005 10 15 bring sheet front when showing option pane filechooser show message sheet sheet listener <br>1 0 1 2005 10 08 clear value <br>1 0 september 25 2005 created j sheet j dialog listener list listener list listener list = listener list handler used handle movements owner owner moves we have change location sheet well component listener owner movement handler non we put owner specified location when sheet hidden point shift back location we need keep track old owner position order avoid processing duplicate owner moved events point old location focus owner on owner window before sheet shown component old focus owner set when listeners j sheet are installed on parent component installed set j sheet uses transition effect when shown when hidden animated = creates j sheet j sheet frame owner owner init creates j sheet j sheet dialog owner owner init init get owner != show sheet set undecorated get root pane set window decoration style j root pane n o n e get root pane set border u i manager get border sheet border we move sheet when user moves owner so always stay centered below title bar owner user has moved owner we forget shift back location t shift owner back place was when we opened sheet owner movement handler = component adapter component moved component evt window owner = get owner point location = owner get location ! location equals old location set location location x + owner get width get width 2 location y + owner get insets top shift back location = old location = location show sheet u i manager get sheet show sheet installs sheet on owner invoked just before j sheet shown install sheet ! installed window owner = get owner owner != determine location sheet owner sheet visible we have shift owner fully display dialog we remember shift back position point owner loc = owner get location point sheet loc show sheet owner j frame sheet loc = point owner loc x + owner get width get width 2 owner loc y + owner get insets top + j frame owner get root pane get content pane get y owner j dialog sheet loc = point owner loc x + owner get width get width 2 owner loc y + owner get insets top + j dialog owner get root pane get content pane get y sheet loc = point owner loc x + owner get width get width 2 owner loc y + owner get insets top sheet loc x < 0 owner set location owner loc x sheet loc x owner loc y sheet loc x = 0 shift back location = owner loc old location = owner get location shift back location = old location = owner loc sheet loc = point owner loc x + owner get width get width 2 owner loc y + owner get height get height 2 set location sheet loc old focus owner = owner get focus owner owner set focusable window state owner set enabled j frame owner set resizable u i manager get sheet show sheet owner add component listener owner movement handler owner frame set title frame owner get title installed = uninstalls sheet on owner invoked immediately after j sheet hidden uninstall sheet installed window owner = get owner owner != owner set focusable window state owner set enabled j frame owner set resizable owner remove component listener owner movement handler shift back location != owner set location shift back location old focus owner != owner front old focus owner request focus installed = add notify add notify u i manager get sheet show sheet ch quaqua quaqua utilities set window alpha window t y p e 240 quaqua utilities set window alpha 240 set j sheet uses transition effect when shown when hidden set animated value old value = animated animated = value fire property change animated old value value j sheet uses transition effect when shown when hidden animated animated dispose dispose uninstall sheet hide0 hide show0 show hide animated show sheet get content pane set visible rectangle start bounds = get bounds parent width = get parent get width rectangle end bounds = rectangle parent width < start bounds width ? start bounds x + start bounds width parent width 2 start bounds x start bounds y math start bounds width parent width 0 timer timer = timer 20 timer add action listener action listener start time end time action performed action evt now = current time millis start time == 0 start time = now end time = start time + 200 now > end time timer stop hide0 set bounds start bounds get content pane set visible uninstall sheet ratio = now start time end time start time set bounds start bounds x 1f ratio + end bounds x ratio start bounds y 1f ratio + end bounds y ratio start bounds width 1f ratio + end bounds width ratio start bounds height 1f ratio + end bounds height ratio timer set repeats timer set initial delay 5 timer start hide0 uninstall sheet show animated show sheet install sheet get content pane set visible start time = current time millis end time = start time + 300 rectangle end bounds = get bounds parent width = get parent get width rectangle start bounds = rectangle parent width < end bounds width ? end bounds x + end bounds width parent width 2 end bounds x end bounds y math end bounds width parent width 0 set bounds start bounds show0 timer timer = timer 20 timer add action listener action listener start time end time action performed action evt now = current time millis start time == 0 start time = now end time = start time + 200 now > end time timer stop set bounds end bounds get content pane set visible request focus reinserted window get parent front ratio = now start time end time start time set bounds start bounds x 1f ratio + end bounds x ratio start bounds y 1f ratio + end bounds y ratio start bounds width 1f ratio + end bounds width ratio start bounds height 1f ratio + end bounds height ratio timer set repeats timer set initial delay 5 timer start install sheet show0 adds sheet listener add sheet listener sheet listener l listener list add sheet listener l removes sheet listener remove sheet listener sheet listener l listener list remove sheet listener l notify listeners have registered interest notification on type instance lazily created using passed fire fire option selected j option pane pane value = pane get value option value == option = j option pane l o s e d o p t i o n pane get options == value option = value value option = j option pane l o s e d o p t i o n option = j option pane l o s e d o p t i o n options = pane get options i = 0 n = options length i < n i++ options i equals value option = i option == j option pane l o s e d o p t i o n value = fire option selected pane option value pane get input value notify listeners have registered interest notification on type instance lazily created using passed fire fire option selected j option pane pane option value input value sheet sheet = guaranteed non listeners = listener list get listener list process listeners last first notifying those are interested i = listeners length 2 i>=0 i =2 listeners i == sheet listener lazily create sheet == sheet = sheet pane option value input value sheet listener listeners i+1 option selected sheet notify listeners have registered interest notification on type instance lazily created using passed fire fire option selected j chooser pane option sheet sheet = guaranteed non listeners = listener list get listener list process listeners last first notifying those are interested i = listeners length 2 i>=0 i =2 listeners i == sheet listener lazily create sheet == sheet = sheet pane option sheet listener listeners i+1 option selected sheet displays option pane sheet on parent window pane option pane parent component parent option pane listener listener sheet events show sheet j option pane pane component parent component sheet listener listener j sheet sheet = create sheet pane parent component style message type pane get message type sheet add sheet listener listener sheet show brings up sheet options <i> yes< i> <i> no< i> <i> cancel< i> parent component determines <code> frame< code> which sheet displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display ??? listener listener sheet events show confirm sheet component parent component message sheet listener listener show confirm sheet parent component message j option pane y e s n o n e l o p t i o n listener brings up sheet where number choices determined <code>option type< code> parameter parent component determines <code> frame< code> which sheet displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display option type designating options available on dialog <code> y e s n o o p t i o n< code> <code> y e s n o n e l o p t i o n< code> ??? listener listener sheet events show confirm sheet component parent component message option type sheet listener listener show confirm sheet parent component message option type j option pane q u e s t i o n m e s s g e listener brings up sheet where number choices determined <code>option type< code> parameter where <code>message type< code> parameter determines icon display <code>message type< code> parameter primarily used supply icon look feel parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display option type designating options available on dialog <code> y e s n o o p t i o n< code> <code> y e s n o n e l o p t i o n< code> message type designating kind message primarily used determine icon pluggable look feel <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> ??? listener listener sheet events show confirm sheet component parent component message option type message type sheet listener listener show confirm sheet parent component message option type message type listener brings up sheet specified icon where number choices determined <code>option type< code> parameter <code>message type< code> parameter primarily used supply icon look feel parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message display option type designating options available on dialog <code> y e s n o o p t i o n< code> <code> y e s n o n e l o p t i o n< code> message type designating kind message primarily used determine icon pluggable look feel <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> icon icon display dialog ??? listener listener sheet events show confirm sheet component parent component message option type message type icon icon sheet listener listener show option sheet parent component message option type message type icon listener shows question message sheet requesting input user parented <code>parent component< code> parent component parent <code> component< code> dialog ??? listener listener sheet events show input sheet component parent component message sheet listener listener show input sheet parent component message j option pane q u e s t i o n m e s s g e listener shows question message sheet requesting input user parented <code>parent component< code> input value initialized <code>initial selection value< code> parent component parent <code> component< code> dialog message <code> object< code> display initial selection value value used initialize input field ??? listener listener sheet events show input sheet component parent component message initial selection value sheet listener listener show input sheet parent component message j option pane q u e s t i o n m e s s g e initial selection value listener shows sheet requesting input user parented <code>parent component< code> message type <code>message type< code> parent component parent <code> component< code> dialog message <code> object< code> display message type type message displayed <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> ??? listener listener sheet events show input sheet component parent component message message type sheet listener listener show input sheet parent component message message type listener prompts user input sheet where initial selection possible selections other options specified user able choose <code>selection values< code> where <code>null< code> implies user input whatever they wish usually means <code> j text field< code> <code>initial selection value< code> initial value prompt user up u i decide how best represent <code>selection values< code> usually <code> j combo box< code> <code> j list< code> <code> j text field< code> used parent component parent <code> component< code> dialog message <code> object< code> display message type type message displayed <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> icon <code> icon< code> image display selection values <code> object< code>s gives possible selections initial selection value value used initialize input field ??? listener listener sheet events show input sheet component parent component message message type icon icon selection values initial selection value sheet listener listener j option pane pane = j option pane message message type j option pane o k n e l o p t i o n icon pane set wants input pane set selection values selection values pane set initial selection value initial selection value pane set component orientation parent component == ? j option pane get root frame parent component get component orientation style = style message type message type j sheet sheet = create sheet pane parent component style pane select initial value sheet add window listener window adapter window closed window evt sheet dispose sheet add sheet listener listener sheet show sheet front brings up message sheet parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display show message sheet component parent component message show message sheet parent component message j option pane i n f o r m t i o n m e s s g e brings up message sheet parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display listener listener notified when sheet dismissed show message sheet component parent component message sheet listener listener show message sheet parent component message j option pane i n f o r m t i o n m e s s g e listener brings up sheet displays message using icon determined <code>message type< code> parameter parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display message type type message displayed <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> show message sheet component parent component message message type show message sheet parent component message message type brings up sheet displays message using icon determined <code>message type< code> parameter parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display message type type message displayed <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> listener listener notified when sheet dismissed show message sheet component parent component message message type sheet listener listener show message sheet parent component message message type listener brings up sheet displaying message specifying parent component determines <code> frame< code> which sheet displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display message type type message displayed <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> icon icon display sheet helps user identify kind message displayed listener listener notified when sheet dismissed show message sheet component parent component message message type icon icon sheet listener listener show option sheet parent component message j option pane d e f u l t o p t i o n message type icon listener brings up sheet specified icon where initial choice determined <code>initial value< code> parameter number choices determined <code>option type< code> parameter <p> <code>option type< code> <code> y e s n o o p t i o n< code> <code> y e s n o n e l o p t i o n< code> <code>options< code> parameter <code>null< code> then options are supplied look feel <p> <code>message type< code> parameter primarily used supply icon look feel parent component determines <code> frame< code> which dialog displayed <code>null< code> <code>parent component< code> has <code> frame< code> sheet displayed dialog message <code> object< code> display option type designating options available on dialog <code> y e s n o o p t i o n< code> <code> y e s n o n e l o p t i o n< code> message type designating kind message primarily used determine icon pluggable look feel <code> j option pane e r r o r m e s s g e< code> <code> j option pane i n f o r m t i o n m e s s g e< code> <code> j option pane r n i n g m e s s g e< code> <code> j option pane q u e s t i o n m e s s g e< code> <code> j option pane p l i n m e s s g e< code> icon icon display dialog options indicating possible choices user make are components they are rendered properly non <code> string< code> are rendered using their <code>to string< code> parameter <code>null< code> options are determined look feel initial value represents selection dialog meaningful <code>options< code> used <code>null< code> ??? listener listener sheet events show option sheet component parent component message option type message type icon icon options initial value sheet listener listener j option pane pane = j option pane message message type option type icon options initial value pane set initial value initial value pane set component orientation parent component == ? j option pane get root frame parent component get component orientation style = style message type message type j sheet sheet = create sheet pane parent component style pane select initial value sheet add sheet listener listener sheet show sheet front style message type message type message type j option pane e r r o r m e s s g e j root pane e r r o r d i l o g j option pane q u e s t i o n m e s s g e j root pane q u e s t i o n d i l o g j option pane r n i n g m e s s g e j root pane r n i n g d i l o g j option pane i n f o r m t i o n m e s s g e j root pane i n f o r m t i o n d i l o g j option pane p l i n m e s s g e j root pane p l i n d i l o g j sheet create sheet j option pane pane component parent component style window window = get window component parent component j sheet sheet window frame sheet = j sheet frame window sheet = j sheet dialog window container content pane = sheet get content pane content pane set layout border layout content pane add pane border layout e n t e r sheet set resizable sheet add window listener window adapter got focus = count window closing window we pane set value window closed window we pane get value == j option pane u n i n i t i l i z e d v l u e sheet fire option selected pane window gained focus window we once window gets focus set initial focus !got focus ugly dirty hack j option pane select initial value so we call directly u i cause mayhem because we override encapsulation pane select initial value option pane u i ui = pane get u i ui != ui select initial value pane got focus = sheet add component listener component adapter component shown component ce reset value ensure closing works properly pane set value j option pane u n i n i t i l i z e d v l u e pane add property change listener property change listener property change property change let close operation handle closing user closed window selecting button value = otherwise close sheet sheet visible get == pane get property equals j option pane v l u e p r o p e r t y get value != get value != j option pane u n i n i t i l i z e d v l u e sheet set visible sheet fire option selected pane sheet pack sheet specified component s toplevel <code> frame< code> <code> dialog< code> parent component <code> component< code> check <code> frame< code> <code> dialog< code> <code> frame< code> <code> dialog< code> contains component frame component <code>null< code> does have valid <code> frame< code> <code> dialog< code> parent window get window component component parent component parent component == j option pane get root frame parent component frame || parent component dialog window parent component get window component parent component get parent displays save chooser sheet note text appears approve button determined l f parent parent component dialog <code>null< code> ??? listener listener sheet events show save sheet j chooser chooser component parent sheet listener listener chooser set dialog type j chooser s v e d i l o g show sheet chooser parent listener displays open chooser sheet note text appears approve button determined l f parent parent component dialog <code>null< code> ??? listener listener sheet events show open sheet j chooser chooser component parent sheet listener listener chooser set dialog type j chooser o p e n d i l o g show sheet chooser parent listener displays custom chooser sheet custom approve button parent parent component dialog <code>null< code> approve button text text <code> approve button< code> ??? listener listener sheet events show sheet j chooser chooser component parent approve button text sheet listener listener approve button text != chooser set approve button text approve button text chooser set dialog type j chooser u s t o m d i l o g begin create dialog frame frame = parent frame ? frame parent frame utilities get ancestor frame parent title = chooser get u i get dialog title chooser chooser get accessible context set accessible description title j sheet sheet = j sheet frame sheet add sheet listener listener container content pane = sheet get content pane content pane set layout border layout content pane add chooser border layout e n t e r end create dialog action listener action listener = action listener action performed action evt option evt get action command equals approve selection option = j chooser p p r o v e o p t i o n option = j chooser n e l o p t i o n sheet hide sheet fire option selected chooser option chooser remove action listener chooser add action listener action listener sheet add window listener window adapter window closing window e sheet fire option selected chooser j chooser n e l o p t i o n chooser remove action listener action listener chooser rescan current directory sheet pack sheet show sheet front 